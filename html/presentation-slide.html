<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Preview – Seminar Proposal Tesis Virda Nur Lu'lu</title>
<style>
  html,body{margin:0;background:#000;color:#fff;font-family:Arial, sans-serif}
  .wrap{min-height:100svh;display:grid;place-items:center;padding:20px}
  .viewer{width:min(1100px,96vw);aspect-ratio:16/9;background:#111;position:relative;border:1px solid rgba(255,255,255,.2);border-radius:12px;overflow:hidden}
  iframe,object{position:absolute;inset:0;width:100%;height:100%;border:0}
  .topbar{position:absolute;inset:auto 0 0 0;display:flex;gap:10px;justify-content:center;padding:10px;background:linear-gradient(180deg,transparent,rgba(0,0,0,.6))}
  .btn{background:#2563eb;border:0;color:#fff;padding:8px 12px;border-radius:8px;cursor:pointer}
  .btn.ghost{background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.25)}
  .status{position:absolute;left:12px;top:12px;background:rgba(0,0,0,.55);border:1px solid rgba(255,255,255,.2);padding:6px 10px;border-radius:999px;font-size:12px}
</style>
</head>
<body>
<div class="wrap">
  <div class="viewer" id="viewer">
    <div class="status" id="status">Trying Office Viewer (PPTX)…</div>
    <iframe id="frame" title="Preview"></iframe>
    <div class="topbar">
      <a id="openFull" class="btn" target="_blank" rel="noopener">Buka layar penuh</a>
      <a id="download" class="btn ghost" target="_blank" rel="noopener">Unduh file</a>
    </div>
  </div>
</div>

<script>
(function(){
  // ======== CONFIG — ganti sesuai file kamu =========
  const URL_PPTX = "https://virdanurlulu.github.io/paper/seminar-tesis-virda-nur-lulu.pptx";
  const URL_PPSX = "https://virdanurlulu.github.io/paper/seminar-tesis-virda-nur-lulu.ppsx";
  const URL_PDF  = "https://virdanurlulu.github.io/paper/seminar-tesis-virda-nur-lulu.pdf";
  // ==================================================

  const office = (u)=>"https://view.officeapps.live.com/op/embed.aspx?src="+encodeURIComponent(u)+"&wdAr=1.7777777777777777";
  const gview  = (u)=>"https://docs.google.com/gview?embedded=true&url="+encodeURIComponent(u);

  const chain = [
    {name:"Office Viewer (PPTX)", src: office(URL_PPTX), full: office(URL_PPTX), dl: URL_PPTX},
    {name:"Office Viewer (PPSX)", src: office(URL_PPSX), full: office(URL_PPSX), dl: URL_PPSX},
    {name:"Google Viewer (PPTX)", src: gview(URL_PPTX),  full: gview(URL_PPTX),  dl: URL_PPTX},
    {name:"Google Viewer (PDF)",  src: gview(URL_PDF),   full: gview(URL_PDF),   dl: URL_PDF},
    {name:"PDF Embed",            src: URL_PDF,          full: URL_PDF,          dl: URL_PDF, type:"pdf"}
  ];

  const frame = document.getElementById('frame');
  const status = document.getElementById('status');
  const openFull = document.getElementById('openFull');
  const download = document.getElementById('download');

  let i = 0, ok = false, timer;

  function tryNext(){
    if(i>=chain.length){
      status.textContent = "Gagal preview. Silakan unduh file.";
      frame.remove();
      return;
    }
    const opt = chain[i++];
    status.textContent = "Trying "+opt.name+"…";

    // untuk PDF terakhir pakai <object>
    if(opt.type === "pdf"){
      const obj = document.createElement('object');
      obj.type = "application/pdf";
      obj.data = opt.src;
      frame.replaceWith(obj);
    } else {
      if(!frame.isConnected) location.reload(); // simple reset jika sudah diganti
      frame.src = opt.src;
    }

    openFull.href = opt.full;
    download.href = opt.dl;

    // kalau 6 detik tidak onload → anggap gagal, lanjut
    clearTimeout(timer);
    timer = setTimeout(()=>{
      if(!ok){ tryNext(); }
    }, 6000);
  }

  // sukses load (untuk tahap iframe)
  frame.addEventListener('load', function(){
    ok = true;
    status.textContent = "Loaded.";
  });

  tryNext();
})();
</script>
</body>
</html>
