<script>
(function(){
  // ========== CONFIG ==========
  // Sekarang kita hanya fokus pada format .pptx yang lebih kompatibel
  const URL_PPTX_JSDELIVR = "https://cdn.jsdelivr.net/gh/virdanurlulu/virdanurlulu.github.io@main/paper/seminar-virda-2025-v1.pptx";
  const URL_PPTX_PAGES    = "https://virdanurlulu.github.io/paper/seminar-virda-2025-v1.pptx";
  const URL_PDF           = "https://virdanurlulu.github.io/paper/seminar-virda-2025-v1.pdf";
  // ================================================

  const office = (u)=>"https://view.officeapps.live.com/op/embed.aspx?src="+encodeURIComponent(u)+"&wdAr=1.7777777777777777";
  const gview  = (u)=>"https://docs.google.com/gview?embedded=true&url="+encodeURIComponent(u);

  // Chain disederhanakan, menghapus upaya memuat .ppsx
  const chain = [
    {name:"Office Viewer (jsDelivr)", src: office(URL_PPTX_JSDELIVR), full: office(URL_PPTX_JSDELIVR), dl: URL_PPTX_JSDELIVR},
    {name:"Office Viewer (GitHub Pages)", src: office(URL_PPTX_PAGES), full: office(URL_PPTX_PAGES), dl: URL_PPTX_PAGES},
    {name:"Google Viewer (PPTX)", src: gview(URL_PPTX_JSDELIVR), full: gview(URL_PPTX_JSDELIVR), dl: URL_PPTX_JSDELIVR},
    {name:"Google Viewer (PDF)", src: gview(URL_PDF), full: gview(URL_PDF), dl: URL_PDF},
    {name:"PDF Embed", src: URL_PDF, full: URL_PDF, dl: URL_PDF, type:"pdf"}
  ];

  // ... sisa skrip lainnya tidak perlu diubah ...

  const frame = document.getElementById('frame');
  const status = document.getElementById('status');
  const openFull = document.getElementById('openFull');
  const download = document.getElementById('download');

  let i = 0, loaded = false, timer;

  function tryNext(){
    if(i>=chain.length){
      status.textContent = "Gagal preview. Gunakan tombol Unduh file.";
      if(frame.parentNode) frame.parentNode.removeChild(frame);
      return;
    }
    const opt = chain[i++];
    status.textContent = "Mencoba "+opt.name+"â€¦";

    if(opt.type === "pdf"){
      const obj = document.createElement('object');
      obj.type = "application/pdf";
      obj.data = opt.src;
      if(frame.parentNode) frame.parentNode.replaceChild(obj, frame);
    } else {
      if(!frame.isConnected) location.reload();
      frame.src = opt.src;
    }
    openFull.href = opt.full;
    download.href = opt.dl;

    loaded = false;
    clearTimeout(timer);
    timer = setTimeout(()=>{ if(!loaded) tryNext(); }, 6000);
  }

  frame.addEventListener('load', function(){ loaded = true; status.textContent = "Berhasil dimuat."; });
  tryNext();
})();
</script>
