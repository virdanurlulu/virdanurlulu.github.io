<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Replace with your page's title -->
  <title>Simulation and Modeling of Explosion Effects Based on TNT Equivalence using Javascript</title>

  <!-- Replace with your icon's path -->
  <link rel="icon" type="image/x-icon" href="/img/favicon.ico">
  <!-- Replace with your page's canonical URL -->
  <link rel="canonical" href="https://virdanurlulu.github.io/">
  <link rel="preconnect" href="https://raw.githubusercontent.com" crossorigin>
  <link rel="dns-prefetch" href="//raw.githubusercontent.com">
  <!-- Replace with a relevant preload image -->
  <link rel="preload" as="image" href="/img/banner-itb1.webp">

  <!-- Replace SEO meta tags to match your page content -->
  <meta name="description" content="Interactive web application for the simulation and modeling of explosion effects based on TNT equivalence.">
  <meta name="author" content="Virda Nur Lu'lu">
  <meta name="robots" content="index,follow">
  <meta name="theme-color" content="#0079c2">
  <meta name="color-scheme" content="light dark">

  <!-- Replace Open Graph (OG) Properties -->
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="Masterâ€™s Program in Chemical Engineering, Bandung Institute of Technology">
  <meta property="og:title" content="Simulation and Modeling of Explosion Effects Based on TNT Equivalence using Javascript">
  <meta property="og:description" content="Interactive web application for the simulation and modeling of explosion effects based on TNT equivalence.">
  <meta property="og:url" content="https://virdanurlulu.github.io/">
  <meta property="og:image" content="/img/ITB-Exlosion-Modeling-Simulation.webp">
  <meta property="og:image:type" content="image/webp">

  <!-- Replace Twitter Card Properties -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Simulation and Modeling of Explosion Effects Based on TNT Equivalence using Javascript">
  <meta name="twitter:description" content="Interactive web application for the simulation and modeling of explosion effects based on TNT equivalence.">
  <meta name="twitter:image" content="/img/ITB-Exlosion-Modeling-Simulation.webp">

  <!-- Replace LD+JSON Script -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Explosion Effects Simulation & Modeling (TNT Equivalence)",
    "applicationCategory": "EducationalApplication",
    "operatingSystem": "Web",
    "url": "https://virdanurlulu.github.io/",
    "image": "/img/ITB-Exlosion-Modeling-Simulation.webp",
    "author": {"@type": "Person", "name": "Virda Nur Lu'lu", "sameAs": ["https://id.linkedin.com/in/virdanurlulu"]},
    "inLanguage": "en",
    "description": "Interactive web application for the simulation and modeling of explosion effects based on TNT equivalence.",
    "publisher": {"@type": "Organization", "name": "Institut Teknologi Bandung", "url": "https://che.itb.ac.id/"}
  }
  </script>

  <style>
    /* CSS Styles - Unchanged from the original script */
    :root {
      --ink: #1e2b3b;
      --muted: #64748b;
      --card: #ffffff;
      --bg: #f5f7fb;
      --blue-itb: #0079c2;
      --stripe: #eaf3fb;
      --ring: rgba(0, 121, 194, 0.25);
      --danger: #DC2626;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    html { scroll-behavior: smooth; }
    body {
      margin: 0;
      background: var(--bg);
      color: var(--ink);
      font: 16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }
    body.dragging {
      user-select: none;
    }
    .wrap { max-width: 1280px; margin: 32px auto; padding-left: max(16px, env(safe-area-inset-left)); padding-right: max(16px, env(safe-area-inset-right)); }
    body.full .wrap { max-width: none; width: 100%; padding: 0; margin: 0 auto; }
    body.full .banner, body.full .split { padding-left: max(20px, env(safe-area-inset-left)); padding-right: max(20px, env(safe-area-inset-right)); }
    body.full .banner { border-radius: 0; padding-top: clamp(16px, 2.2vw, 24px); padding-bottom: clamp(16px, 2.2vw, 24px); margin-bottom: 18px; }
    body.full .split { margin-top: 18px; }
    .title { display: grid; gap: 6px; }
    .title h1 { margin: 0; font-size: clamp(24px, 3.2vw, 44px); line-height: 1.25; font-family: Georgia, "Times New Roman", serif; color: #fff; padding: 6px 10px; border-radius: 10px; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15); max-width: clamp(560px, 70vw, 62ch); }
    @supports (text-wrap: balance) { .title h1 { text-wrap: balance; } }
    .title h2 { margin: 0; font-size: clamp(12px, 1.2vw, 16px); font-weight: 600; color: #fff; }
    .banner { position: relative; color: #fff; background-image: url("/img/banner-itb1.webp"); background-size: cover; background-position: center; padding: clamp(16px, 2.2vw, 24px) clamp(16px, 2.4vw, 28px); min-height: clamp(120px, 20vw, 240px); border-radius: 14px; box-shadow: 0 6px 20px rgba(2, 41, 77, 0.12); margin-bottom: 18px; }
    .title h1, .title h2 { text-shadow: 0 1px 2px rgba(0, 0, 0, 0.25); }
    .brandbar { display: flex; align-items: center; gap: 16px; }
    .brand-logo { height: clamp(56px, 6.5vw, 96px); width: auto; }
    .nowrap { white-space: nowrap; }
    .brand-text { display: flex; flex-direction: column; gap: 6px; }
    .card { background: var(--card); border-radius: 14px; overflow: hidden; box-shadow: 0 4px 14px rgba(10, 34, 64, 0.08); margin-bottom: 18px; }
    .card-header { background: var(--blue-itb); color: #e9f5ff; font-weight: 700; padding: 10px 14px; font-family: Georgia, "Times New Roman", serif; display: flex; justify-content: space-between; align-items: center; position: relative; }
    .app-footer { margin-top: 20px; color: #fff; background-color: var(--blue-itb); width: 100vw; margin-left: calc(50% - 50vw); padding: 24px 16px; border-top: 1px solid rgba(255, 255, 255, 0.25); text-align: center; }
    .app-footer .footer-content { max-width: 1280px; margin: 0 auto; display: flex; flex-direction: column; align-items: center; gap: 20px; }
    .app-footer .credit { font-weight: 700; color: #e9f5ff; }
    .app-footer .dedication { font-size: 13px; line-height: 1.6; max-width: 960px; }
    .app-footer a:not(.btn-home-3d) { color: #fff; text-decoration: none; }
    .btn-home-3d { --button-bg-top: #CC00CC; --button-bg-bottom: #990099; --button-shadow: #660066; --button-active-shadow: #440044; display: inline-flex; align-items: center; justify-content: center; padding: 1px 20px; font-size: 12px; font-weight: normal; color: #ffffff; background: linear-gradient(to bottom, var(--button-bg-top) 0%, var(--button-bg-bottom) 100%); border: none; border-radius: 8px; cursor: pointer; position: relative; outline: none; transform: translateY(0); transition: all 0.2s ease; box-shadow: 0 4px 0 var(--button-shadow); text-decoration: none; }
    .btn-home-3d:hover { transform: translateY(-2px); box-shadow: 0 6px 0 var(--button-shadow); }
    .btn-home-3d:active { transform: translateY(2px); box-shadow: 0 2px 0 var(--button-active-shadow); }
    .footer-buttons { display: flex; flex-wrap: wrap; justify-content: center; gap: 12px; }
    .dropdown-menu { position: fixed; top: clamp(16px, 2.2vw, 24px); right: clamp(16px, 2.4vw, 28px); z-index: 1000; }
    .dropdown-toggle { background-color: rgba(255, 255, 255, 0.9); color: var(--ink); padding: 8px 16px; font-size: 16px; font-weight: 600; border: none; border-radius: 8px; cursor: pointer; transition: background-color 0.2s ease; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    .dropdown-toggle:hover { background-color: #ffffff; }
    .dropdown-content { display: none; position: absolute; right: 0; top: 110%; background-color: #ffffff; min-width: 220px; box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2); border-radius: 8px; overflow: hidden; opacity: 0; visibility: hidden; transform: translateY(-10px); transition: opacity 0.3s ease, transform 0.3s ease, visibility 0.3s; }
    .dropdown-menu.is-active .dropdown-content { display: block; opacity: 1; visibility: visible; transform: translateY(0); }
    .dropdown-content a { color: var(--ink); padding: 12px 16px; text-decoration: none; display: block; transition: background-color 0.2s ease, color 0.2s ease; font-weight: 500; white-space: nowrap; }
    .dropdown-content a:hover { background-color: var(--stripe); color: var(--blue-itb); }
    .split { display: grid; grid-template-columns: 70% 30%; gap: 18px; }
    .left, .right { display: flex; flex-direction: column; gap: 18px; }
    .right { position: sticky; top: 12px; align-self: start; }
    .toc-list {
        list-style-type: none;
        padding: 0;
        margin: 0;
    }
    .toc-list li a {
        display: block;
        padding: 12px 14px;
        text-decoration: none;
        color: var(--ink);
        border-bottom: 1px solid var(--stripe);
        transition: background-color 0.2s ease, color 0.2s ease;
        font-weight: 500;
    }
    .toc-list li:last-child a {
        border-bottom: none;
    }
    .toc-list li a:hover {
        background-color: var(--stripe);
        color: var(--blue-itb);
    }
    #toTop { position: fixed; bottom: 20px; right: 20px; z-index: 1000; cursor: pointer; border-radius: 50%; width: 50px; height: 50px; padding: 0; display: flex; align-items: center; justify-content: center; background-color: var(--blue-itb); color: white; border: none; box-shadow: 0 4px 8px rgba(0,0,0,0.2); font-size: 24px; opacity: 0; visibility: hidden; transform: translateY(20px); transition: opacity 0.3s ease, transform 0.3s ease, visibility 0.3s; }
    #toTop.show { opacity: 1; visibility: visible; transform: translateY(0); }
    #toTop:hover { background-color: #005a8c; }
    #floatingControlPanel { display: none; position: fixed; z-index: 1001; background-color: var(--card); border-radius: 14px; box-shadow: 0 8px 24px rgba(0,0,0,0.15); transition: all 0.4s ease-in-out; width: auto; max-width: 90%; left: 50%; bottom: 20px; transform: translateX(-50%); }
    #floatingControlPanel.visible { display: block; }
    .floating-panel-header { cursor: move; padding: 10px 14px; background-color: var(--blue-itb); color: white; border-top-left-radius: 14px; border-top-right-radius: 14px; display: flex; justify-content: space-between; align-items: center; }
    .floating-panel-header h3 { margin: 0; font-size: 12px; font-family: Georgia, "Times New Roman", serif; transition: opacity 0.3s ease; }
    .floating-panel-action-btn { width: 24px; height: 24px; border-radius: 50%; background: rgba(255,255,255,0.2); color: white; border: none; cursor: pointer; font-size: 14px; line-height: 1; display: flex; align-items: center; justify-content: center; transition: transform 0.3s ease; }
    .floating-panel-body { display: grid; grid-template-areas: "inputs outputs"; grid-template-columns: auto auto; gap: 16px; padding: 14px; align-items: start; max-height: 500px; overflow: hidden; transition: max-height 0.4s ease-in-out, padding 0.4s ease-in-out, opacity 0.4s ease-in-out;}
    #floatingControlPanel.collapsed { width: 44px !important; height: 44px; border-radius: 50%; bottom: auto; left: auto; top: var(--target-top, 20px); right: var(--target-right, 20px); transform: none; overflow: hidden; }
    #floatingControlPanel.collapsed .floating-panel-header { padding: 10px; cursor: pointer; }
    #floatingControlPanel.collapsed h3, #floatingControlPanel.collapsed .floating-panel-body { display: none; }
    #floatingControlPanel.collapsed #floatPanelCollapseBtn { transform: rotate(180deg); }
    #floatPanelInputs { grid-area: inputs; display: flex; flex-direction: column; gap: 10px; }
    #floatPanelOutputs { grid-area: outputs; display: flex; flex-direction: column; gap: 4px; padding-left: 16px; border-left: 2px solid var(--stripe); }
    #floatingControlPanel .label { font-size: 11px; }
    #floatingControlPanel input, #floatingControlPanel select { font-size: 11px; padding: 8px 10px; min-height: 25px; }

    /* Media Queries */
    @media (max-width: 1024px) {
      .split { 
        display: flex;
        flex-direction: column;
      }
      .right { 
        position: static; 
        order: -1;
      }
    }
    @media (max-width: 768px) and (orientation: portrait) {
      /* Specific styles for mobile portrait mode */
    }
    @media (max-width: 1024px) and (orientation: landscape) {
      /* Specific styles for tablet landscape */
    }
    @media (max-width: 720px) {
      body { font-size: 14px; }
      .app-footer .footer-content { gap: 16px; }
      .app-footer .credit, .app-footer .dedication { text-align: center; }
      .card-header, .label { font-size: 14px; }
      .btn-home-3d { font-size: 12px; padding: 4px 12px; box-shadow: 0 3px 0 var(--button-shadow); }
      .btn-home-3d:hover { transform: translateY(-2px); box-shadow: 0 5px 0 var(--button-shadow); }
      .btn-home-3d:active { transform: translateY(1px); box-shadow: 0 2px 0 var(--button-active-shadow); }
      .title h2 .sub-line1, .title h2 .sub-line2 { display: block; }
    }
    @media (max-width: 480px) {
      .card-header { flex-direction: column; gap: 8px; align-items: flex-start; }
      .dropdown-menu { top: 12px; right: 12px; }
      .dropdown-toggle { padding: 6px 12px; font-size: 14px; }
    }
    @media (max-height: 450px) and (orientation: landscape) {
      .banner { padding: 8px 12px; display: flex; align-items: center; gap: 12px; }
      .brandbar { flex-grow: 1; gap: 12px; }
      .brand-logo { height: 40px; }
      .title h1 { font-size: 14px; padding: 4px 8px; }
      .title h2 { font-size: 10px; }
      .dropdown-menu { position: static; top: auto; right: auto; }
      .dropdown-toggle { padding: 6px 10px; font-size: 12px; }
      .app-footer { padding: 12px 16px; }
      .footer-buttons { gap: 6px; }
      .btn-home-3d { padding: 1px 10px; font-size: 10px; box-shadow: 0 2px 0 var(--button-shadow); }
    }
  </style>
</head>
<body class="theme-itb full">
  <div class="wrap">
    <header class="banner title" role="banner">
      <div class="brandbar">
        <!-- Replace homepage link and logo path -->
        <a href="https://virdanurlulu.github.io/" target="_blank" rel="noopener noreferrer" aria-label="Visit homepage">
          <img id="itbLogo" class="brand-logo" alt="ITB Logo" width="96" height="96">
        </a>
        <div class="brand-text">
          <!-- Replace header title and subtitle -->
          <h1>Simulation and Modeling of Explosion Effects Based on TNT Equivalence using Javascript</h1>
          <h2>
            <span class="sub-line1">Thesis Masterâ€™s Program in Chemical Engineering, </span>
            <span class="sub-line2">Bandung Institute of Technology</span>
          </h2>
        </div>
      </div>

      <nav class="dropdown-menu" aria-label="Main Navigation">
        <button class="dropdown-toggle">Menu &#9776;</button>
        <div class="dropdown-content">
          <!-- Replace menu links -->
          <a href="/">Home</a>
          <a href="/html/simulation-modeling-visualisation-explosion.html">Simulation & Modeling Application</a>
          <a href="#">Simulation Guide (coming soon)</a>
          <a href="#">Presentation (coming soon)</a>
          <a href="#">Journal & Conference (coming soon)</a>
          <a href="/html/bibliography_sim_modeling_explosion.html">Bibliography</a>
        </div>
      </nav>
    </header>

    <main class="split" role="main">
      <div class="left">
        <!-- MAIN CONTENT FOR THE LEFT PANEL GOES HERE -->
        <section id="abstract" class="card" aria-labelledby="abstract-title">
          <h2 id="abstract-title" class="card-header">Abstract</h2>
          <div style="padding:14px">
            <p>Content for the abstract will be displayed here upon clicking the corresponding link.</p>
          </div>
        </section>

        <section id="foreword" class="card" aria-labelledby="foreword-title">
          <h2 id="foreword-title" class="card-header">Foreword</h2>
          <div style="padding:14px">
            <p>Content for the foreword will be displayed here.</p>
          </div>
        </section>

        <section id="introduction" class="card" aria-labelledby="introduction-title">
          <h2 id="introduction-title" class="card-header">Introduction</h2>
          <div style="padding:14px">
            <p>Content for the introduction will be displayed here.</p>
          </div>
        </section>

        <section id="literature-review" class="card" aria-labelledby="literature-title">
          <h2 id="literature-title" class="card-header">Literature Review</h2>
          <div style="padding:14px">
            <p>Content for the literature review will be displayed here.</p>
          </div>
        </section>

        <section id="research-methodology" class="card" aria-labelledby="methodology-title">
          <h2 id="methodology-title" class="card-header">Research Methodology</h2>
          <div style="padding:14px">
            <p>Content for the research methodology will be displayed here.</p>
          </div>
        </section>
      </div>

      <aside class="right">
        <!-- SIDEBAR CONTENT GOES HERE -->
        <section class="card" aria-labelledby="toc-title">
          <h2 id="toc-title" class="card-header">Table of Contents</h2>
          <div>
            <ul class="toc-list">
              <li><a href="#abstract">Abstract</a></li>
              <li><a href="#foreword">Foreword</a></li>
              <li><a href="#introduction">Introduction</a></li>
              <li><a href="#literature-review">Literature Review</a></li>
              <li><a href="#research-methodology">Research Methodology</a></li>
            </ul>
          </div>
        </section>
      </aside>
    </main>
  </div>
    
  <div id="floatingControlPanel">
      <div class="floating-panel-header">
          <h3>Quick Control Panel</h3>
          <div class="panel-header-buttons">
            <button id="floatPanelCollapseBtn" class="floating-panel-action-btn" aria-label="Collapse/Expand Panel">â–²</button>
          </div>
      </div>
      <div class="floating-panel-body">
          <div id="floatPanelInputs">
            <!-- Inputs for the floating panel will be generated by JavaScript -->
          </div>
          <div id="floatPanelOutputs">
            <!-- Outputs for the floating panel will be generated by JavaScript -->
          </div>
      </div>
  </div>

  <footer class="app-footer">
      <div class="footer-content">
        <div class="footer-buttons">
          <!-- Replace footer links -->
          <a class="btn-home-3d" href="/" target="_blank" rel="noopener noreferrer">Home</a>
          <a class="btn-home-3d" href="#">About</a>
          <a class="btn-home-3d" href="#">Contact</a>
          <a class="btn-home-3d" href="https://id.linkedin.com/in/virdanurlulu">Profile</a>
        </div>
        <div class="credit">Copyright Â© 2025 by
          <a href="https://id.linkedin.com/in/virdanurlulu" target="_blank" rel="nofollow noopener noreferrer" style="text-decoration: none;">Virda Nur Lu'lu</a>
        </div>
        <div class="dedication">
          <!-- Replace footer dedication text -->
          This application is dedicated to my parents for their persistent support and patient guidance throughout my JavaScript journey. It is also presented to the academic community atÂ <a href="https://che.itb.ac.id/" target="_blank" rel="nofollow noopener noreferrer">Institut Teknologi Bandung</a>Â as a contribution towards inspiring further advancements in JavaScript technology.
        </div>
      </div>
  </footer>

  <button class="btn" id="toTop" type="button" aria-label="Back to top">&#8679;</button>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const $ = (id) => document.getElementById(id);

      // --- Basic UI Functions ---

      function loadLogo() {
        const img = $("itbLogo"); if (!img) return;
        const fallback = 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="256" height="256"><circle cx="128" cy="128" r="120" fill="%230079c2"/><text x="50%" y="56%" font-family="Georgia, serif" font-size="88" text-anchor="middle" fill="white">ITB</text></svg>';
        img.onerror = () => { img.onerror = null; img.src = fallback; };
        // Replace your logo path here
        img.src = "/img/Logo_Institut_Teknologi_Bandung.webp";
      }

      function goTop() {
        try { window.scrollTo({ top: 0, behavior: "smooth" }); }
        catch (e) { window.scrollTo(0, 0); }
      }

      function setupDropdownMenu() {
        const dropdown = document.querySelector('.dropdown-menu');
        if (!dropdown) return;
        const dropdownToggle = dropdown.querySelector('.dropdown-toggle');
        if (dropdownToggle) {
          dropdownToggle.addEventListener('click', (event) => {
            event.stopPropagation();
            dropdown.classList.toggle('is-active');
          });
        }
        document.addEventListener('click', (event) => {
          if (dropdown.classList.contains('is-active') && !dropdown.contains(event.target)) {
            dropdown.classList.remove('is-active');
          }
        });
      }

      function setupScrollToTopButton() {
        const toTopBtn = $('toTop');
        if (!toTopBtn) return;
        window.addEventListener('scroll', () => {
          if (window.scrollY > 200) {
            toTopBtn.classList.add('show');
          } else {
            toTopBtn.classList.remove('show');
          }
        });
        toTopBtn.addEventListener('click', goTop);
      }
      
      function debounce(func, delay = 250) {
        let timeoutId;
        return function(...args) {
          clearTimeout(timeoutId);
          timeoutId = setTimeout(() => { func.apply(this, args); }, delay);
        };
      }

      // --- Floating Panel Functions ---
      
      function setupFloatingPanel() {
        const floatInputs = $('floatPanelInputs');
        const floatOutputs = $('floatPanelOutputs');
        
        if (floatInputs) {
            // You can populate default panel content here if needed
            floatInputs.innerHTML = `<p>Quick Controls</p>`;
        }
        if (floatOutputs) {
            floatOutputs.innerHTML = `<p>Quick Results</p>`;
        }
      }

      function makeDraggable(panel, handle) {
        let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
        let isDragging = false;

        const dragStart = (e) => {
          if (panel.classList.contains('collapsed')) return;
          isDragging = true;
          panel.style.transition = 'none';
          const rect = panel.getBoundingClientRect();
          panel.style.width = rect.width + 'px';
          panel.style.left = rect.left + 'px';
          panel.style.transform = 'none';

          let currentEvent = e.type.startsWith('touch') ? e.touches[0] : e;
          pos3 = currentEvent.clientX;
          pos4 = currentEvent.clientY;
          
          document.addEventListener('mouseup', dragEnd);
          document.addEventListener('mousemove', elementDrag);
          document.addEventListener('touchend', dragEnd);
          document.addEventListener('touchmove', elementDrag, { passive: false });
          document.body.classList.add('dragging');
        };
        
        handle.addEventListener('mousedown', dragStart);
        handle.addEventListener('touchstart', dragStart, { passive: false });

        function elementDrag(e) {
          if (!isDragging) return;
          if (e.type === 'touchmove') e.preventDefault();
          
          let currentEvent = e.type.startsWith('touch') ? e.touches[0] : e;
          if (!currentEvent.clientX) return;
          
          pos1 = pos3 - currentEvent.clientX;
          pos2 = pos4 - currentEvent.clientY;
          pos3 = currentEvent.clientX;
          pos4 = currentEvent.clientY;
          
          panel.style.top = (panel.offsetTop - pos2) + "px";
          panel.style.left = (panel.offsetLeft - pos1) + "px";
          panel.style.bottom = 'auto';
        }

        function dragEnd() {
          if (!isDragging) return;
          isDragging = false;
          panel.style.transition = '';
          panel.style.width = '';
          document.removeEventListener('mouseup', dragEnd);
          document.removeEventListener('mousemove', elementDrag);
          document.removeEventListener('touchend', dragEnd);
          document.removeEventListener('touchmove', elementDrag);
          document.body.classList.remove('dragging');
        }
      }
      
      function setupCollapsePanel() {
        const panel = $('floatingControlPanel');
        if (!panel) return;
        const collapseBtn = $('floatPanelCollapseBtn');
        const header = panel.querySelector('.floating-panel-header');

        collapseBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            const isCollapsed = panel.classList.toggle('collapsed');
            if (isCollapsed) {
                const rect = panel.getBoundingClientRect();
                panel.style.setProperty('--target-top', `${rect.top}px`);
                panel.style.setProperty('--target-right', `${window.innerWidth - rect.right}px`);
            } else {
                panel.style.width = '';
            }
        });

        header.addEventListener('click', (e) => {
            if (panel.classList.contains('collapsed') && e.target !== collapseBtn && !collapseBtn.contains(e.target)) {
                panel.classList.remove('collapsed');
                panel.style.width = '';
            }
        });
      }
      
      function handlePanelVisibility() {
        const floatingPanel = $('floatingControlPanel');
        // Replace 'main' with a trigger element ID if needed
        const triggerElement = document.querySelector('main'); 
        if (!triggerElement || !floatingPanel) return;

        const triggerRect = triggerElement.getBoundingClientRect();
        // Show the panel when the trigger element is scrolled out of view
        if (triggerRect.top < -200) { 
          floatingPanel.classList.add('visible');
        } else {
          floatingPanel.classList.remove('visible');
        }
      }

      // --- Initialization ---
      loadLogo();
      setupDropdownMenu();
      setupScrollToTopButton();

      const floatingPanel = $('floatingControlPanel');
      if (floatingPanel) {
        setupFloatingPanel();
        makeDraggable(floatingPanel, floatingPanel.querySelector('.floating-panel-header'));
        setupCollapsePanel();
        window.addEventListener('scroll', debounce(handlePanelVisibility, 100));
        window.addEventListener('resize', debounce(handlePanelVisibility, 100));
      }
      
      // --- ADD YOUR PAGE-SPECIFIC JAVASCRIPT HERE ---
      console.log("Template loaded successfully.");
      
    });
  </script>
</body>
</html>


